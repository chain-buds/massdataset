source("~/tidymass/massdataset/R/activate_mass_dataset.R")
object_pos =
object_pos %>%
activate_mass_dataset(what = "sample_info") %>%
left_join(sample_info_pos,
by = "sample_id")
object_pos %>%
extract_sample_info() %>%
head()
object_pos@sample_info
getwd()
setwd("~/tidymass/massdataset")
devtools::document()
devtools::build()
devtools::check()
?left_join
?left_join
?dplyr::left_join
getwd()
devtools::document()
devtools::build()
devtools::check()
devtools::document()
devtools::build()
devtools::check()
pkgdown::build_site()
source("~/tidymass/massdataset/R/dplyr_left_join.R")
devtools::document()
source("~/tidymass/massdataset/R/dplyr_left_join.R")
devtools::document()
devtools::document()
rm(list=ls())
devtools::document()
devtools::build()
devtools::check()
?left_join
?dplyr::left_join
getwd()
devtools::document()
devtools::build()
devtools::check()
pkgdown::build_site()
getwd()
setwd("vignettes/")
library(tidyverse)
peak_table_pos = readr::read_csv("feature_table/Peak_table_pos.csv")
peak_table_neg = readr::read_csv("feature_table/Peak_table_neg.csv")
sample_info_pos = readr::read_csv("feature_table/sample_info_pos.csv")
sample_info_neg = readr::read_csv("feature_table/sample_info_neg.csv")
expression_data_pos =
peak_table_pos %>%
dplyr::select(-c(variable_id:rt)) %>%
as.data.frame()
variable_info_pos =
peak_table_pos %>%
dplyr::select(variable_id:rt) %>%
as.data.frame()
rownames(expression_data_pos) = variable_info_pos$variable_id
expression_data_neg =
peak_table_neg %>%
dplyr::select(-c(variable_id:rt)) %>%
as.data.frame()
variable_info_neg =
peak_table_neg %>%
dplyr::select(variable_id:rt) %>%
as.data.frame()
rownames(expression_data_neg) = variable_info_neg$variable_id
colnames(expression_data_pos) == sample_info_pos$sample_id
colnames(expression_data_neg) == sample_info_neg$sample_id
expression_data_pos =
peak_table_pos %>%
dplyr::select(-c(variable_id:rt)) %>%
as.data.frame()
variable_info_pos =
peak_table_pos %>%
dplyr::select(variable_id:rt) %>%
as.data.frame()
rownames(expression_data_pos) = variable_info_pos$variable_id
expression_data_neg =
peak_table_neg %>%
dplyr::select(-c(variable_id:rt)) %>%
as.data.frame()
variable_info_neg =
peak_table_neg %>%
dplyr::select(variable_id:rt) %>%
as.data.frame()
rownames(expression_data_neg) = variable_info_neg$variable_id
library(tidyverse)
peak_table_pos = readr::read_csv("feature_table/Peak_table_pos.csv")
peak_table_neg = readr::read_csv("feature_table/Peak_table_neg.csv")
sample_info_pos = readr::read_csv("feature_table/sample_info_pos.csv")
sample_info_neg = readr::read_csv("feature_table/sample_info_neg.csv")
library(tidyverse)
peak_table_pos = readr::read_csv("feature_table/Peak_table_pos.csv")
peak_table_neg = readr::read_csv("feature_table/Peak_table_neg.csv")
sample_info_pos = readr::read_csv("feature_table/sample_info_pos.csv")
sample_info_neg = readr::read_csv("feature_table/sample_info_neg.csv")
expression_data_pos =
peak_table_pos %>%
dplyr::select(-c(variable_id:rt)) %>%
as.data.frame()
variable_info_pos =
peak_table_pos %>%
dplyr::select(variable_id:rt) %>%
as.data.frame()
rownames(expression_data_pos) = variable_info_pos$variable_id
expression_data_neg =
peak_table_neg %>%
dplyr::select(-c(variable_id:rt)) %>%
as.data.frame()
variable_info_neg =
peak_table_neg %>%
dplyr::select(variable_id:rt) %>%
as.data.frame()
rownames(expression_data_neg) = variable_info_neg$variable_id
colnames(expression_data_pos) == sample_info_pos$sample_id
colnames(expression_data_neg) == sample_info_neg$sample_id
```
The orders of `sample_id` in `sample_info` and column names of `expression_data` are different.
```{r,eval=TRUE,warning=FALSE, R.options="", message=TRUE, cache=TRUE}
expression_data_pos =
expression_data_pos[,sample_info_pos$sample_id]
expression_data_neg =
expression_data_neg[,sample_info_neg$sample_id]
colnames(expression_data_pos) == sample_info_pos$sample_id
colnames(expression_data_neg) == sample_info_neg$sample_id
library(massdataset)
object_pos =
create_mass_dataset(
expression_data = expression_data_pos,
sample_info = sample_info_pos,
variable_info = variable_info_pos
)
object_pos
object_neg =
create_mass_dataset(
expression_data = expression_data_neg,
sample_info = sample_info_neg,
variable_info = variable_info_neg
)
save(object_pos, file = "feature_table/object_pos")
save(object_neg, file = "feature_table/object_neg")
export_mass_dataset(object = object_pos,
file_type = "xlsx",
path = "demo_data_pos")
object = object_pos
file_type = "xlsx"
path = "demo_data_pos"
object@ms2_data
###ms2_data
export_ms2_data(object = object@ms2_data,
file_type = ms2_file_type,
path = path)
source("~/tidymass/massdataset/R/export_mass_dataset.R")
devtools::document()
devtools::build()
devtools::check()
pkgdown::build_site()
getwd()
setwd("..")
pkgdown::build_site()
library(massdataset)
library(tidyverse)
data("expression_data")
data("sample_info")
data("sample_info_note")
data("variable_info")
data("variable_info_note")
object =
create_mass_dataset(
expression_data = expression_data,
sample_info = sample_info,
variable_info = variable_info,
sample_info_note = sample_info_note,
variable_info_note = variable_info_note
)
new_sample_info =
data.frame(sample_id = c("PS4P1", "PS4P2"),
BMI = c(20, 22))
object2 =
object %>%
activate_mass_dataset(what = "sample_info") %>%
left_join(new_sample_info, by = "sample_id")
rm(list=ls())
library(massdataset)
library(tidyverse)
library(massdataset)
library(tidyverse)
data("expression_data")
data("sample_info")
data("sample_info_note")
data("variable_info")
data("variable_info_note")
object =
create_mass_dataset(
expression_data = expression_data,
sample_info = sample_info,
variable_info = variable_info,
sample_info_note = sample_info_note,
variable_info_note = variable_info_note
)
new_sample_info =
data.frame(sample_id = c("PS4P1", "PS4P2"),
BMI = c(20, 22))
object2 =
object %>%
activate_mass_dataset(what = "sample_info") %>%
left_join(new_sample_info, by = "sample_id")
object2
library(massdataset)
library(tidyverse)
data("expression_data")
data("sample_info")
data("sample_info_note")
data("variable_info")
data("variable_info_note")
object =
create_mass_dataset(
expression_data = expression_data,
sample_info = sample_info,
variable_info = variable_info,
sample_info_note = sample_info_note,
variable_info_note = variable_info_note
)
new_sample_info =
data.frame(sample_id = c("PS4P1", "PS4P2"),
BMI = c(20, 22))
object2 =
object %>%
activate_mass_dataset(what = "sample_info") %>%
left_join(new_sample_info, by = "sample_id")
ls()
source("~/tidymass/massdataset/R/mutate_ms2.R")
devtools::install_github("tidymass/masstools")
library(masstools)
source("~/tidymass/massdataset/R/mutate_ms2.R")
getwd()
devtools::document()
devtools::build()
devtools::check()
devtools::document()
devtools::build()
devtools::check()
devtools::document()
devtools::install_github("tidymass/masstools")
devtools::document()
devtools::build()
devtools::check()
source("~/tidymass/massdataset/R/dplyr_filter.R")
getwd()
devtools::document()
devtools::build()
devtools::document()
devtools::build()
devtools::check()
?create_mass_dataset
ata("expression_data")
data("sample_info")
data("sample_info_note")
data("variable_info")
data("variable_info_note")
object =
create_mass_dataset(
expression_data = expression_data,
sample_info = sample_info,
variable_info = variable_info,
sample_info_note = sample_info_note,
variable_info_note = variable_info_note
)
object@annotation_table
source("~/tidymass/massdataset/R/dplyr_filter.R")
devtools::document()
devtools::build()
devtools::check()
source("~/tidymass/massdataset/R/dplyr_filter.R")
source("~/tidymass/massdataset/R/dplyr_filter.R")
devtools::document()
devtools::build()
devtools::check()
source("~/tidymass/massdataset/R/dplyr_filter.R")
setwd("/Users/xiaotaoshen/tidymass/tidymass/vignettes")
load("metabolite_annotation/object_pos2")
source("~/tidymass/massdataset/R/dplyr_filter.R")
object_pos2 %>%
activate_mass_dataset(what = "annotation_table") %>%
filter(!is.na(Level)) %>%
filter(Level == 1 | Level == 2)
library(tidyverse)
object_pos2 %>%
activate_mass_dataset(what = "annotation_table") %>%
filter(!is.na(Level)) %>%
filter(Level == 1 | Level == 2)
source("~/tidymass/massdataset/R/activate_mass_dataset.R")
object_pos2 %>%
activate_mass_dataset(what = "annotation_table") %>%
filter(!is.na(Level)) %>%
filter(Level == 1 | Level == 2)
source("~/tidymass/massdataset/R/data_checking.R")
object_pos2 %>%
activate_mass_dataset(what = "annotation_table") %>%
filter(!is.na(Level)) %>%
filter(Level == 1 | Level == 2)
object_pos2 %>%
activate_mass_dataset(what = "annotation_table") %>%
filter(!is.na(Level))
.data = object_pos2
.data@activated
object_pos2 =
object_pos2 %>%
activate_mass_dataset(what = "annotation_table")
.data = object_pos2
.data@activated == "annotation_table"
.data@annotation_table
nrow(.data@annotation_table) > 0
.data@annotation_table$variable_id
.data@variable_info %>%
dplyr::filter(variable_id %in% .data@annotation_table$variable_id)
.data@variable_info %>%
filter(variable_id %in% .data@annotation_table$variable_id)
.data@annotation_table$variable_id
.data@variable_info
.data@variable_info %>%
filter(variable_id %in% .data@annotation_table$variable_id
.data@variable_info %>%
filter(variable_id %in% .data@annotation_table$variable_id
)
.data@variable_info %>%
filter(variable_id %in% .data@annotation_table$variable_id)
.data@annotation_table$variable_id
.data@variable_info %>%
filter(variable_id %in% .data@annotation_table$variable_id)
.data@annotation_table$variable_id
annotation_table = .data@annotation_table
annotation_table$variable_id
.data@variable_info %>%
filter(variable_id %in% annotation_table$variable_id)
.data@variable_info %>%
filter(variable_id %in% annotation_table$variable_id)
.data@expression_data[x$variable_id, ,drop = FALSE]
.data@annotation_table
.data@annotation_table %>%
dplyr::filter(variable_id %in% .data@variable_info$variable_id)
variable_info <- .data@variable_info
source("~/tidymass/massdataset/R/dplyr_filter.R")
object_pos2 %>%
activate_mass_dataset(what = "annotation_table") %>%
filter(!is.na(Level))
getwd()
setwd("~/tidymass/massdataset/R")
getwd()
devtools::document()
devtools::build()
devtools::check()
source("~/tidymass/massdataset/R/dplyr_filter.R")
devtools::document()
devtools::build()
devtools::check()
devtools::document()
devtools::build()
devtools::document()
devtools::build()
devtools::check()
devtools::document()
devtools::build()
devtools::check()
source("~/tidymass/massdataset/R/report_parameters.R")
devtools::document()
devtools::build()
devtools::check()
stats::time()
devtools::document()
devtools::build()
devtools::check()
massdataset_version
devtools::document()
devtools::build()
devtools::check()
devtools::document()
devtools::build()
devtools::check()
object
object@ms2_data
c(object@ms2_data,object@ms2_data)
getwd()
setwd("..")
devtools::document()
devtools::build()
devtools::check()
devtools::document()
getwd()
devtools::build()
devtools::check()
library(plyr)
?dlply
stop("activate you object using activate_mass_dataset() first.\n")
source("~/tidymass/massdataset/R/plyr-dlply.R")
object
object %>% activate_mass_dataset("variable_info")
object %>% activate_mass_dataset("variable_info") %>% dlply(.variables = .(variable_id))
source("~/tidymass/massdataset/R/plyr-dlply.R")
object %>% activate_mass_dataset("variable_info") %>% dlply(.variables = .(variable_id))
.data@activated
source("~/tidymass/massdataset/R/plyr-dlply.R")
source("~/tidymass/massdataset/R/plyr-dlply.R")
slot(object = .data,
name = "activated")
activated <-
slot(object = .data,
name = "activated")
source("~/tidymass/massdataset/R/plyr-dlply.R")
source("~/tidymass/massdataset/R/plyr-dlply.R")
object %>% activate_mass_dataset("variable_info") %>% dlply(.variables = .(variable_id))
activated
temp_slot =
slot(object = .data,
name = activated)
temp_slot
dlply(.data = temp_slot, .variables = .(variable_id))
source("~/tidymass/massdataset/R/plyr-dlply.R")
object %>% activate_mass_dataset("variable_info") %>% dlply(.variables = .(variable_id))
temp_slot %>% dlply(.variables = .(variable_id))
object %>% activate_mass_dataset("variable_info") %>% dlply(.variables = .(variable_id))
library(plyr)
help(package = "plyr")
source("~/tidymass/massdataset/R/plyr-dlply.R")
dlply(.data = .data, .variables = .(Level))
dlply(.data = temp_slot, .variables = .(Level))
?dlply
dlply(.data = .data, .variables = .(variable_id))
dlply(.data = .data@variable_info, .variables = .(variable_id))
source("~/tidymass/massdataset/R/plyr-dlply.R")
dlply(.data = .data, .variables = .(variable_id))
class(.data)
source("~/tidymass/massdataset/R/plyr-dlply.R")
slot(object = .data, name = "activated")
source("~/tidymass/massdataset/R/activate_mass_dataset.R")
source("~/tidymass/massdataset/R/activate_mass_dataset.R")
slot(object = .data, name = "activated")
what
what = "annotation_table"
slot(object = .data, name = "activated") <- what
temp_slot
source("~/tidymass/massdataset/R/plyr-dlply.R")
dlply(.data = .data, .variables = .(Level))
class(temp_slot)
source("~/tidymass/massdataset/R/plyr-dlply.R")
dlply(.data = .data, .variables = .(Level))
dlply(.data = .data, .variables = .(Level))
?splitter_d
?as.quoted
?llply
source("~/tidymass/massdataset/R/plyr-dlply.R")
dlply(.data = .data, .variables = .(Level))
source("~/tidymass/massdataset/R/plyr-dlply.R")
dlply(.data = .data, .variables = .(Level))
dlply(.data = temp_slot, .variables = .(Level))
?splitter_d
?split
equire(stats); require(graphics)
n <- 10; nn <- 100
g <- factor(round(n * runif(n * nn)))
x <- rnorm(n * nn) + sqrt(as.numeric(g))
x
class(x)
g
g <- airquality$Month
g
airquality
split(airquality, airquality$Month)
?split
activated <-
slot(object = .data,
name = "activated")
activated
if (length(activated) == 0) {
stop("activate you object using activate_mass_dataset() first.\n")
}
temp_slot <-
slot(object = .data,
name = activated)
source("~/tidymass/massdataset/R/plyr-dlply.R")
split(.data, f = "Level")
f
f = "Level"
temp_slot[,f, drop = TRUE]
source("~/tidymass/massdataset/R/plyr-dlply.R")
source("~/tidymass/massdataset/R/plyr-dlply.R")
split(.data, f = "Level")
source("~/tidymass/massdataset/R/plyr-dlply.R")
split(.data, f = "Level")
split(.data, f = .data@annotation_table$Level)
source("~/tidymass/massdataset/R/split.R")
source("~/tidymass/massdataset/R/split.R")
?lapply
getwd()
devtools::document()
devtools::build()
devtools::check()
source("~/tidymass/massdataset/R/merge_mass_dataset.R")
devtools::document()
devtools::build()
devtools::check()
?slice
dplyr::slice()
?dplyr::slice()
source("~/tidymass/massdataset/R/report_parameters.R")
devtools::document()
devtools::build()
devtools::check()
devtools::document()
devtools::build()
devtools::check()
